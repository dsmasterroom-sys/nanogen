# 2026-02-21 작업 기록 (Workflow Studio)

## 오늘 완료한 주요 작업

1. 워크플로 저장/복원 안정화
- 저장 구조를 서버 우선 + 로컬 백업(IndexedDB/localStorage)으로 정리
- 노드 내부 데이터(텍스트/이미지/프롬프트/결과/뷰 상태) 저장/복원 경로 보강
- 로드 타이밍 이슈로 인한 복원 누락/리사이즈 핸들 누락 보정

2. 워크플로 노드 기능 확장
- 노드별 실행 버튼 추가 (해당 노드 + 의존 노드 실행)
- Generator에 Prompt/Result 토글 뷰 추가
- Generator 출력 타입(image/prompt/video)별 모델 선택 로직 분리

3. UI 개선
- 노드 카드형 UI 통일 (타이틀바 + 카드 컨테이너)
- 텍스트/제너레이터 내부 선 제거 및 레이아웃 미세 조정
- 제너레이터 토글 버튼과 입력 영역 겹침 이슈 해결 (입력 상단 패딩 조정)

4. 라이브러리/생성 결과 처리
- 생성 이미지 Source Library 자동 저장
- 이미지 다운로드 동작 안정화(fetch/blob 방식)

5. 서버 저장 API 추가
- `/api/workflow/store` GET/POST 추가
- `WorkflowStore` 모델 및 마이그레이션 추가

## 내일 시작 전 필수 체크

1. 마이그레이션 적용
```bash
cd Master/nanogen_django
python manage.py migrate
```
- 미적용 시 에러: `no such table: nanogen_workflowstore`

2. 워크플로 저장 검증 시나리오
- 텍스트 노드 작성 -> 저장 -> 새로고침 -> 내용 복원 확인
- 이미지 인풋 업로드/라이브러리 선택 -> 저장 -> 복원 확인
- 제너레이터 Prompt/Result 상태 전환 -> 저장 -> 복원 확인
- 노드 리사이즈 후 저장 -> 복원 시 크기 유지 확인

## 내일 우선 작업 권장 순서

1. 서버 DB 저장 정상화 확인 (마이그레이션 후)
2. 저장/복원 E2E 테스트로 잔여 누락 케이스 확인
3. UI 통일성 최종 미세 조정 (간격/타이포/아이콘 정렬)
4. 필요 시 워크플로 저장 버전 히스토리(스냅샷) 기능 추가

## 참고 변경 파일
- `nanogen/static/nanogen/js/app.js`
- `nanogen/templates/nanogen/index.html`
- `nanogen/services.py`
- `nanogen/views.py`
- `nanogen/urls.py`
- `nanogen/models.py`
- `nanogen/migrations/0004_workflowstore.py`
